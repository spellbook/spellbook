this.Spellbook={},this.Spellbook.AutoDuplicateInput=function(){var e,t,n,r,s,a,i,o,l,u,c;return o={},e=0,n=null,l={email:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/},c=function(e){return o=$.extend({$element:$(".js-autoDuplicateInput"),$container:$(".js-autoDuplicateInput-container"),clonedDataAttribute:"cloned",validateDataAttribute:"validate",invalidClass:"is-invalid",validClass:"is-valid",onDuplicate:null,onInvalid:null,onValid:null},e),a()},a=function(){return o.$element.on("keyup",function(r){if(r.preventDefault(),n=$(this),s()){if(i("valid"),null!=o.onValid&&o.onValid(o),"true"!==n.data("cloned")&&t(),null!=o.onDuplicate)return o.onDuplicate(o,e)}else if(i("invalid"),null!=o.onInvalid)return o.onInvalid(o)})},r=function(){return n.data(o.validateDataAttribute)},s=function(){var e;return e=r(n),l[""+e].test(n.val())},t=function(){return++e,n.data(o.clonedDataAttribute,"true").clone(!0).appendTo(o.$container).removeClass(o.validClass).val("").data(o.clonedDataAttribute,"")},i=function(e){switch(e){case"invalid":return n.removeClass(o.validClass).addClass(o.invalidClass);case"valid":return n.removeClass(o.invalidClass).addClass(o.validClass)}},u=function(){return e},{init:c,getCount:u}}(),this.Spellbook.autoSubmit=function(e){var t;return t=$.extend({$element:$(".js-autoSubmit")},e),t.$element.on("change",function(){return $(this).closest("form").trigger("submit")})},this.Spellbook.clickOut=function(e){var t;return t=$.extend({$element:$(".js-clickout"),run:null},e),$(document).on("click",function(){return t.run()}),t.$element.on("click",function(e){return e.stopPropagation()})},this.Spellbook.Dematerialize=function(){function e(e){this.options=e,this._settings=$.extend({$element:$(".js-dematerialize"),$trigger:$(".js-dematerialize-trigger"),itemTitle:"hidden_element",hiddenClass:"is-hidden"},this.options)}return e._settings={},e._item="",e.prototype.init=function(){return this._setEventHandlers(),this._setInitialState()},e.prototype._setEventHandlers=function(){return this._settings.$trigger instanceof jQuery?this._settings.$trigger.on("click",function(e){return function(t){return t.preventDefault(),e._toggleState()}}(this)):this._toggleStateViaKey()},e.prototype._setInitialState=function(){return this._item=localStorage.getItem(this._settings.itemTitle),"true"!==this._item?this._settings.$element.removeClass(this._settings.hiddenClass):void 0},e.prototype._toggleState=function(){return this._settings.$element.hasClass(this._settings.hiddenClass)?(this._settings.$element.removeClass(this._settings.hiddenClass),this._item=localStorage.removeItem(this._settings.itemTitle)):(this._settings.$element.addClass(this._settings.hiddenClass),this._item=localStorage.setItem(this._settings.itemTitle,"true"))},e.prototype._toggleStateViaKey=function(){return $(document).on("keyup",function(e){return function(t){var n;switch(n=t.target.tagName.toLowerCase(),t.which){case e._settings.$trigger:if("input"!==n&&"textarea"!==n)return e._toggleState()}}}(this))},e}();var bind=function(e,t){return function(){return e.apply(t,arguments)}};this.Spellbook.DrawSvg=function(){function e(e){this.options=e,this.draw=bind(this.draw,this),this.init()}return e.prototype._settings={},e.prototype._paths=[],e.prototype._lengths=[],e.prototype._currentFrame=0,e.prototype._totalFrames=60,e.prototype._handle=0,e.prototype._progress=0,e.prototype.init=function(){return this._settings=$.extend({$element:$(".js-drawSvg"),prefix:"path"},this.options),this._setStorage()},e.prototype._setStorage=function(){var e,t,n,r,s,a;for(r=this._settings.$element.find("path[id]").length,a=[],t=e=0,s=r;s>=0?s>e:e>s;t=s>=0?++e:--e)this._paths[t]=document.getElementById(this._settings.prefix+"-"+t),n=this._paths[t].getTotalLength(),this._lengths[t]=n,this._paths[t].style.strokeDasharray=n+" "+n,a.push(this._paths[t].style.strokeDashoffset=n);return a},e.prototype._setStroke=function(){var e,t,n,r;for(r=[],t=e=0,n=this._paths.length;n>=0?n>e:e>n;t=n>=0?++e:--e)r.push(this._paths[t].style.strokeDashoffset=Math.floor(this._lengths[t]*(1-this._progress)));return r},e.prototype.draw=function(){return this._progress=this._currentFrame/this._totalFrames,this._progress>1?window.cancelAnimationFrame(this._handle):(this._currentFrame++,this._setStroke(),this._handle=window.requestAnimationFrame(this.draw))},e}(),this.Spellbook.EqualHeights=function(){var e,t,n,r,s,a;return r={},e=[],s=null,a=function(e){return r=$.extend({$element:$(".js-equalHeights")},e),n(),t()},n=function(){var t;return r.$element.css("height","auto"),r.$element.each(function(){return e.push($(this).height())}),t=Math.max.apply(Math,e),r.$element.css("height",t)},t=function(){return $(window).on("resize",function(){return clearTimeout(s),s=setTimeout(n,250)})},{init:a}}(),this.Spellbook.escapeOut=function(e){var t;return t=$.extend({run:null},e),$(document).on("keyup",function(e){switch(e.which){case 27:return t.run()}})},this.Spellbook.filter=function(e){var t;return t=$.extend({$element:$(".js-filter"),$item:$(".js-filter-item"),$link:$(".js-filter-link"),$empty:$("<p>There are no items to show.</p>"),activeClass:"is-active",hiddenClass:"is-hidden",dataAttribute:"item"},e),t.$link.on("click",function(e){var n,r,s;return e.preventDefault(),n=$(this),s=n.attr("href").split("#")[1],t.$link.removeClass(t.activeClass),n.toggleClass(t.activeClass),"all"!==s?(t.$item.addClass(t.hiddenClass),r=$("[data-"+t.dataAttribute+"="+s+"]"),r.length>0?r.removeClass(t.hiddenClass):t.$element.append(t.$empty)):t.$item.removeClass(t.hiddenClass)})},this.Spellbook.fixOrphanWords=function(e){var t;return t=$.extend({$element:$(".js-orphan")},e),t.$element.each(function(){var e,t,n,r,s,a;for(e=$(this),a=e.text().split(" "),t="",n=r=0,s=a.length-1;s>=0?s>=r:r>=s;n=s>=0?++r:--r)t+=a[n],t+=n===a.length-2?"&nbsp;":n===a.length-1?"":" ";return e.html(t)})},this.Spellbook.HeadingLinks=function(){var e,t,n,r;return t={},r=function(n){return t=$.extend({$element:$("h1, h2, h3, h4, h5"),anchorClass:"anchor"},n),e()},n=function(e){return e.toLowerCase().replace(/[^\w ]+/g,"").replace(/\s+/g,"-")},e=function(){return t.$element.each(function(){var e,r;return e=$(this),r=n(e.text()),e.attr("id",r),e.prepend("<a class='"+t.anchorClass+"' href='#"+r+"'>#</a>")})},{init:r}}(),this.Spellbook.keyCodes={enter:13,shift:16,ctrl:17,alt:18,esc:27,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,comma:188,slash:191,backslash:220,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90},this.Spellbook.limiter=function(e){var t,n;return n=$.extend({$element:$(".js-limiter-element"),$toggle:$(".js-limiter-toggle"),hiddenClass:"is-hidden",limit:5},e),t=n.$element.length,t>n.limit?(n.$element.not(":lt("+n.limit+")").addClass(n.hiddenClass),n.$toggle.on("click",function(e){return e.preventDefault(),$(this).remove(),n.$element.removeClass(n.hiddenClass)})):n.$toggle.remove()},this.Spellbook.LiveSearch=function(){var e,t,n,r,s,a,i,o,l;return o={},a="",l=function(e){return o=$.extend({$element:$(".js-search"),$query:$(".js-search-query"),$container:$(".js-search-container"),itemNode:".js-search-item",hiddenClass:"is-hidden",emptyMessage:!0,emptyNode:".js-search-empty",onClear:null,onEmpty:null,onFound:null,onKeyup:null},e),i()},i=function(){return o.$element.on("keyup",function(){return a=$(this).val(),null!=o.onKeyup&&o.onKeyup(o),""===a&&($(o.itemNode).removeClass(o.hiddenClass),e(),null!=o.onClear&&o.onClear(o)),e(),s()})},s=function(){return o.$query.each(function(){var e;return e=$(this),r(e)?e.closest(o.itemNode).addClass(o.hiddenClass):(e.closest(o.itemNode).removeClass(o.hiddenClass),null!=o.onFound?o.onFound(o):void 0)}),t()},e=function(){return o.emptyMessage&&$(o.emptyNode).length>0?$(o.emptyNode).remove():void 0},t=function(){var e;return n()&&(o.emptyMessage&&(e=o.emptyNode.replace(".","")),$("<p class='"+e+"'>\n  There are no results matching '"+a+"'.\n</p>").insertAfter(o.$container),null!=o.onEmpty)?o.onEmpty(o):void 0},r=function(e){return e.text().search(new RegExp(a,"i"))<0},n=function(){return $(o.itemNode+"."+o.hiddenClass).length===$(o.itemNode).length},{init:l}}(),this.Spellbook.loader=function(e){var t;return t=$.extend({$element:$(".js-loader-element"),$toggle:$(".js-loader-toggle"),$spinner:$("<span></span>"),$overlay:$("<div></div>"),spinnerClass:"loader",overlayClass:"loader-overlay",loadingClass:"is-loading"},e),t.$toggle.on("click",function(){return t.$element.toggleClass(t.loadingClass),t.$element.append(t.$spinner),t.$spinner.addClass(t.spinnerClass),t.$element.append(t.$overlay),t.$overlay.addClass(t.overlayClass)})},this.Spellbook.Modal=function(){var e,t,n,r,s,a,i,o,l;return t=null,e=null,a={},o=function(e){return a=$.extend({$trigger:$(".js-modal-trigger"),$close:$(".js-modal-close"),dataAttribute:"modal",backdropClass:"modal-backdrop",activeClass:"is-active",inactiveClass:"is-inactive",activeBodyClass:"is-modal-active"},e),s(),this},l=function(e,s,o,l){switch(null==o&&(o=!1),null==l&&(l=null),t=e,s){case"open":e.addClass(a.activeClass),$("body").addClass(a.activeBodyClass);break;case"close":e.removeClass(a.activeClass),$("body").removeClass(a.activeBodyClass),n()}return o||i(s),l&&l(),r()},i=function(t){switch(t){case"open":return $("<div class="+a.backdropClass+"></div>").appendTo($("body")),e=$("."+a.backdropClass),setTimeout(function(){return e.addClass(a.activeClass)},25);case"close":return e.removeClass(a.activeClass),setTimeout(function(){return e.remove()},500)}},s=function(){return a.$trigger.on("click",function(e){var n;return e.preventDefault(),n=$(this).data(a.dataAttribute),t=$(n),l(t,"open")})},r=function(){return a.$close.on("click",function(e){return e.preventDefault(),l(t,"close")}),e.on("click",function(){return l(t,"close")}),$(document).on("keydown",function(e){switch(e.which){case 27:return l(t,"close")}})},n=function(){return a.$close.off("click"),$(document).off("keydown")},{init:o,trigger:l}}(),this.Spellbook.prefixClasses=function(e){var t;return t=$.extend({$element:$(".js-prefixClasses"),query:"[ class ]",prefix:"prefix"},e),t.$element.find(t.query).each(function(){var e,n,r,s,a,i;for(a=this,e=a.className.split(" "),i="",r=0,s=e.length;s>r;r++)n=e[r],i=i+" "+t.prefix+"-"+n;return a.className=i})},this.Spellbook.QuantityInput=function(){var e,t,n,r,s,a,i;return n={},a=null,i=function(r){return n=$.extend({$element:$(".js-quantityInput"),$field:$(".js-quantityInput-field"),$increase:$(".js-quantityInput-increase"),$decrease:$(".js-quantityInput-decrease"),$target:$(".js-quantityInput-target"),targetBaseValue:29,targetValuePrefix:"$",minValue:1,maxValue:100,onIncrease:null,onDecrease:null,onTargetUpdate:null},r),t(),e()},t=function(){return a=parseInt(n.$element.val())},e=function(){return n.$element.on("keyup",function(){return t(),isNaN(a)||a<n.minValue||a>n.maxValue?void 0:s()}),n.$increase.on("click",function(e){return e.preventDefault(),a!==n.maxValue&&s("up"),null!=n.onIncrease?n.onIncrease(n):void 0}),n.$decrease.on("click",function(e){return e.preventDefault(),a!==n.minValue&&s("down"),null!=n.onDecrease?n.onDecrease(n):void 0})},s=function(e){switch(null==e&&(e=""),e){case"up":n.$element.val(++a);break;case"down":n.$element.val(--a);break;default:n.$element.val(a)}return r(),null!=n.onTargetUpdate?n.onTargetUpdate(n):void 0},r=function(){var e;return e=a*n.targetBaseValue,n.$target.text(""+n.targetValuePrefix+e)},{init:i}}(),this.Spellbook.QueryParams=function(){function e(e){this.options=e,this.init()}return e.prototype.params={},e.prototype.variables=[],e.prototype._settings={},e.prototype.init=function(){return this._settings=$.extend({url:null},this.options),this._parseQueryString(this._settings.url),this._sortParams()},e.prototype._parseQueryString=function(e){var t;return t=e?e.split("?")[1]:window.location.search.substring(1),this.variables=t.split("&")},e.prototype._sortParams=function(){var e,t,n,r,s,a;for(s=this.variables,a=[],e=0,t=s.length;t>e;e++)r=s[e],n=r.split("="),a.push(void 0!==n[1]?this.params[n[0]]=n[1]:void 0);return a},e.prototype.allParams=function(){return this.params},e.prototype.matchParamKey=function(e){var t,n,r;n=this.params;for(t in n)if(r=n[t],e===t)return!0;return!1},e.prototype.matchParamValue=function(e){var t,n,r;n=this.params;for(t in n)if(r=n[t],e===r)return!0;return!1},e}(),this.Spellbook.randomizer=function(e){var t;return t=Math.floor(Math.random()*e.length),e[t]},this.Spellbook.sanitize=function(e){return e.replace(/(<([^>]+)>)/gi,"")},this.Spellbook.SaveProgress=function(){var e,t,n,r,s,a;return r={},a=function(e){return r=$.extend({$element:$(".js-saveProgress"),$container:$(".js-saveProgress-container"),dataAttribute:"saveprogress"},e),t(),n()},e=function(e){return e.find(r.$element).each(function(){var e;return e=$(this).data(r.dataAttribute),localStorage.removeItem(e)})},t=function(){return r.$element.each(function(){var e,t,n;return e=$(this),t=e.data(r.dataAttribute),n=localStorage.getItem(t),e.val(n)})},n=function(){return r.$element.on("input",function(){var e,t,n;return e=$(this),t=e.data(r.dataAttribute),n=e.val(),s(t,n)}),r.$container.on("submit",function(){return e($(this))})},s=function(e,t){return localStorage.setItem(e,t)},{init:a}}(),this.Spellbook.scrollTo=function(e){var t;return t=$.extend({$element:$(".js-scrollTo"),speed:250},e),t.$element.on("click",function(e){var n;return e.preventDefault(),n=t.$element.attr("href"),$("body, html").animate({scrollTop:parseInt($(n).offset().top)},t.speed)})},this.Spellbook.scrollTrigger=function(e){var t,n,r;return r=$.extend({$element:$(".js-scrollTrigger"),scrollPadding:400,activeClass:"is-active"},e),n=$(window).scrollTop(),r.$element.offset().top>=0&&(t=n-r.$element.offset().top-r.scrollPadding),!r.$element.hasClass(r.activeClass)&&t?r.$element.addClass(r.activeClass):void 0},this.Spellbook.selectText=function(){var e,t,n,r;return n={},r=function(e){return n=$.extend({$element:$(".js-selectText"),onClick:null},e),t()},e=function(e){var t,n,r;return t=e[0],document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(t),n.select()):window.getSelection?(r=window.getSelection(),n=document.createRange(),n.selectNodeContents(t),r.removeAllRanges(),r.addRange(n)):void 0},t=function(){return n.$element.on("click",function(){return e(n.$element),$(this).trigger("focus").trigger("select"),null!=n.onClick?n.onClick(n):void 0})},{init:r}}(),this.Spellbook.Share=function(){var e,t,n,r;return t={},r=function(n){return t=$.extend({$element:$(".js-share"),popup:{height:400,width:575,left:0,top:0}},n),e()},e=function(){return t.$element.on("click",function(e){var t,r,s,a;return e.preventDefault(),t=$(this),a=t.attr("href"),s=t.data("share-service"),r=t.data("share-text"),n(s,a,r)})},n=function(e,n,r){var s;switch(s="width="+t.popup.width+", height="+t.popup.height+", top="+t.popup.top+", left="+t.popup.left,e){case"twitter":n="https://twitter.com/share?text="+r+"&url="+n;break;case"facebook":n="https://www.facebook.com/sharer/sharer.php?u="+n,e="facebook-share-dialog";break;case"google":n="https://plus.google.com/share?url="+n}return window.open(n,e,s)},{init:r}}(),this.Spellbook.shortcut=function(e){var t;return t=$.extend({$element:$("[data-shortcut]"),dataAttribute:"shortcut",keyCodes:Spellbook.keyCodes},e),t.$element.each(function(){var e;return e=t.keyCodes[$(this).data(t.dataAttribute)],$(document).on("keyup",function(t){return function(n){var r,s;return r=$(t),s=n.target.tagName.toLowerCase(),"input"!==s&&"textarea"!==s&&n.which===e&&(r.trigger("focus").trigger("click"),"a"===r.prop("tagName").toLowerCase())?window.location=r.attr("href"):void 0}}(this))})},this.Spellbook.ShowPassword=function(){var e,t,n,r;return t={},r=function(r){return t=$.extend({$input:$(".js-showPassword-input"),$toggle:$(".js-showPassword-toggle"),showByDefault:!1},r),e(),t.showByDefault?n():void 0},e=function(){return t.$toggle.on("change",function(){var e;return e=$(this).prop("checked"),e?n():t.$input.attr("type","password")})},n=function(){return t.$input.attr("type","text"),t.$toggle.prop("checked",!0)},{init:r}}(),this.Spellbook.slugify=function(e){return e.toLowerCase().replace(/[^\w ]+/g,"").replace(/\s+/g,"-")},this.Spellbook.StateUrls=function(){var e,t,n,r,s,a,i;return s={},i=function(t){return s=$.extend({$element:$(".js-stateUrls"),$link:$(".js-stateUrls-link"),hiddenClass:"is-hidden",activeClass:"is-active",dataAttribute:"state"},t),r(e()),n()},t=function(e){return e.replace(/(<([^>]+)>)/gi,"")},e=function(){var e;return e=window.location.hash?t(window.location.hash):s.$link.first().attr("href")},r=function(e){return s.$element.not(e).addClass(s.hiddenClass),$("[data-"+s.dataAttribute+"="+e+"]").removeClass(s.hiddenClass).addClass(s.activeClass)},n=function(){return s.$link.on("click",function(e){var t,n;return e.preventDefault(),t=$(this),n=t.attr("href"),history.pushState?history.pushState(null,null,n):window.location.hash=n,$(n).length>0?a(t,n):void 0})},a=function(e,t){return s.$link.removeClass(s.activeClass),s.$element.addClass(s.hiddenClass),e.addClass(s.activeClass),$(t).removeClass(s.hiddenClass)},{init:i}}(),this.Spellbook.toggle=function(e){var t;switch(t=$.extend({$element:$(".js-toggle"),proximity:"next",event:"click",toggleClass:"is-hidden",activeClass:"is-active",onClick:null,onMouseover:null,onMouseout:null},e),t.event){case"click":return t.$element.on("click",function(e){var n;switch(e.preventDefault(),n=$(this),null!=t.onClick&&t.onClick(t),t.$element.toggleClass(t.activeClass),t.proximity){case"next":return n.next().toggleClass(t.toggleClass);case"prev":return n.prev().toggleClass(t.toggleClass);case"nextParent":return n.parent().next().toggleClass(t.toggleClass);case"prevParent":return n.parent().prev().toggleClass(t.toggleClass);default:return t.proximity.toggleClass(t.toggleClass)}});case"hover":return t.initialState&&t.initialState(),t.$element.on({mouseenter:function(){var e;switch(e=$(this),null!=t.onMouseover&&t.onMouseover(t),e.addClass(t.activeClass),t.proximity){case"next":return e.next().addClass(t.toggleClass);case"prev":return e.prev().addClass(t.toggleClass);case"nextParent":return e.parent().next().addClass(t.toggleClass);case"prevParent":return e.parent().prev().addClass(t.toggleClass);default:return t.proximity.addClass(t.toggleClass)}},mouseleave:function(){var e;switch(e=$(this),null!=t.onMouseout&&t.onMouseout(t),e.removeClass(t.activeClass),t.proximity){case"next":return e.next().removeClass(t.toggleClass);case"prev":return e.prev().removeClass(t.toggleClass);case"nextParent":return e.parent().next().removeClass(t.toggleClass);case"prevParent":return e.parent().prev().removeClass(t.toggleClass);default:return t.proximity.removeClass(t.toggleClass)}}})}},this.Spellbook.uid=function(e){var t;for(null==e&&(e=10),t="";t.length<e;)t+=Math.random().toString(36).substr(2);return t.substr(0,e)};