this.Spellbook={},this.Spellbook.AutoDuplicateInput=function(){var e,t,n,r,s,a,i,o,l,u,c;return u={},n=0,s=null,c={email:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/},t=function(e){return u=$.extend({$element:$(".js-autoDuplicateInput"),$container:$(".js-autoDuplicateInput-container"),clonedDataAttribute:"cloned",validateDataAttribute:"validate",invalidClass:"is-invalid",validClass:"is-valid",onDuplicate:null,onInvalid:null,onValid:null},e),o()},o=function(){return u.$element.on("keyup",function(e){if(e.preventDefault(),s=$(this),i()){if(l("valid"),null!=u.onValid&&u.onValid(u),"true"!==s.data("cloned")&&r(),null!=u.onDuplicate)return u.onDuplicate(u,n)}else if(l("invalid"),null!=u.onInvalid)return u.onInvalid(u)})},a=function(){return s.data(u.validateDataAttribute)},i=function(){var e;return e=a(s),c[""+e].test(s.val())},r=function(){return++n,s.data(u.clonedDataAttribute,"true").clone(!0).appendTo(u.$container).removeClass(u.validClass).val("").data(u.clonedDataAttribute,"")},l=function(e){switch(e){case"invalid":return s.removeClass(u.validClass).addClass(u.invalidClass);case"valid":return s.removeClass(u.invalidClass).addClass(u.validClass)}},e=function(){return n},{init:t,getCount:e}}(),this.Spellbook.autoSubmit=function(e){var t;return t=$.extend({$element:$(".js-autoSubmit")},e),t.$element.on("change",function(){return $(this).closest("form").trigger("submit")})},this.Spellbook.clickOut=function(e){var t;return t=$.extend({$element:$(".js-clickout"),run:null},e),$(document).on("click",function(){return t.run()}),t.$element.on("click",function(e){return e.stopPropagation()})},this.Spellbook.Dematerialize=function(){function e(e){this.options=e,this._settings=$.extend({$element:$(".js-dematerialize"),$trigger:$(".js-dematerialize-trigger"),itemTitle:"hidden_element",hiddenClass:"is-hidden"},this.options)}return e._settings={},e._item="",e.prototype.init=function(){return this._setEventHandlers(),this._setInitialState()},e.prototype._setEventHandlers=function(){return this._settings.$trigger instanceof jQuery?this._settings.$trigger.on("click",function(e){return function(t){return t.preventDefault(),e._toggleState()}}(this)):this._toggleStateViaKey()},e.prototype._setInitialState=function(){return this._item=localStorage.getItem(this._settings.itemTitle),"true"!==this._item?this._settings.$element.removeClass(this._settings.hiddenClass):void 0},e.prototype._toggleState=function(){return this._settings.$element.hasClass(this._settings.hiddenClass)?(this._settings.$element.removeClass(this._settings.hiddenClass),this._item=localStorage.removeItem(this._settings.itemTitle)):(this._settings.$element.addClass(this._settings.hiddenClass),this._item=localStorage.setItem(this._settings.itemTitle,"true"))},e.prototype._toggleStateViaKey=function(){return $(document).on("keyup",function(e){return function(t){var n;switch(n=t.target.tagName.toLowerCase(),t.which){case e._settings.$trigger:if("input"!==n&&"textarea"!==n)return e._toggleState()}}}(this))},e}();var __bind=function(e,t){return function(){return e.apply(t,arguments)}};this.Spellbook.DrawSvg=function(){function e(e){this.options=e,this.draw=__bind(this.draw,this),this.init()}return e.prototype._settings={},e.prototype._paths=[],e.prototype._lengths=[],e.prototype._currentFrame=0,e.prototype._totalFrames=60,e.prototype._handle=0,e.prototype._progress=0,e.prototype.init=function(){return this._settings=$.extend({$element:$(".js-drawSvg"),prefix:"path"},this.options),this._setStorage()},e.prototype._setStorage=function(){var e,t,n,r,s;for(n=this._settings.$element.find("path").length,s=[],e=r=0;n>=0?n>r:r>n;e=n>=0?++r:--r)this._paths[e]=document.getElementById(""+this._settings.prefix+"-"+e),t=this._paths[e].getTotalLength(),this._lengths[e]=t,this._paths[e].style.strokeDasharray=""+t+" "+t,s.push(this._paths[e].style.strokeDashoffset=t);return s},e.prototype._setStroke=function(){var e,t,n,r;for(r=[],e=t=0,n=this._paths.length;n>=0?n>t:t>n;e=n>=0?++t:--t)r.push(this._paths[e].style.strokeDashoffset=Math.floor(this._lengths[e]*(1-this._progress)));return r},e.prototype.draw=function(){return this._progress=this._currentFrame/this._totalFrames,this._progress>1?window.cancelAnimationFrame(this._handle):(this._currentFrame++,this._setStroke(),this._handle=window.requestAnimationFrame(this.draw))},e}(),this.Spellbook.EqualHeights=function(){var e,t,n,r,s,a;return s={},t=[],a=null,e=function(e){return s=$.extend({$element:$(".js-equalHeights")},e),r(),n()},r=function(){var e;return s.$element.css("height","auto"),s.$element.each(function(){return t.push($(this).height())}),e=Math.max.apply(Math,t),s.$element.css("height",e)},n=function(){return $(window).on("resize",function(){return clearTimeout(a),a=setTimeout(r,250)})},{init:e}}(),this.Spellbook.escapeOut=function(e){var t;return t=$.extend({run:null},e),$(document).on("keyup",function(e){switch(e.which){case 27:return t.run()}})},this.Spellbook.filter=function(e){var t;return t=$.extend({$element:$(".js-filter"),$item:$(".js-filter-item"),$link:$(".js-filter-link"),$empty:$("<p>There are no items to show.</p>"),activeClass:"is-active",hiddenClass:"is-hidden",dataAttribute:"item"},e),t.$link.on("click",function(e){var n,r,s;return e.preventDefault(),n=$(this),s=n.attr("href").split("#")[1],t.$link.removeClass(t.activeClass),n.toggleClass(t.activeClass),"all"!==s?(t.$item.addClass(t.hiddenClass),r=$("[data-"+t.dataAttribute+"="+s+"]"),r.length>0?r.removeClass(t.hiddenClass):t.$element.append(t.$empty)):t.$item.removeClass(t.hiddenClass)})},this.Spellbook.fixOrphanWords=function(e){var t;return t=$.extend({$element:$(".js-orphan")},e),t.$element.each(function(){var e,t,n,r,s,a;for(e=$(this),r=e.text().split(" "),t="",n=s=0,a=r.length-1;a>=0?a>=s:s>=a;n=a>=0?++s:--s)t+=r[n],t+=n===r.length-2?"&nbsp;":n===r.length-1?"":" ";return e.html(t)})},this.Spellbook.HeadingLinks=function(){var e,t,n,r;return n={},e=function(e){return n=$.extend({$element:$("h1, h2, h3, h4, h5"),anchorClass:"anchor"},e),t()},r=function(e){return e.toLowerCase().replace(/[^\w ]+/g,"").replace(/\s+/g,"-")},t=function(){return n.$element.each(function(){var e,t;return e=$(this),t=r(e.text()),e.attr("id",t),e.prepend("<a class='"+n.anchorClass+"' href='#"+t+"'>#</a>")})},{init:e}}(),this.Spellbook.keyCodes={enter:13,shift:16,ctrl:17,alt:18,esc:27,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,comma:188,slash:191,backslash:220,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90},this.Spellbook.limiter=function(e){var t,n;return n=$.extend({$element:$(".js-limiter-element"),$toggle:$(".js-limiter-toggle"),hiddenClass:"is-hidden",limit:5},e),t=n.$element.length,t>n.limit?(n.$element.not(":lt("+n.limit+")").addClass(n.hiddenClass),n.$toggle.on("click",function(e){return e.preventDefault(),$(this).remove(),n.$element.removeClass(n.hiddenClass)})):n.$toggle.remove()},this.Spellbook.LiveSearch=function(){var e,t,n,r,s,a,i,o,l;return l={},i="",e=function(e){return l=$.extend({$element:$(".js-search"),$query:$(".js-search-query"),itemNode:".js-search-item",hiddenClass:"is-hidden",emptyMessage:!0,emptyNode:".js-search-empty",onClear:null,onEmpty:null,onFound:null,onKeyup:null},e),o()},o=function(){return l.$element.on("keyup",function(){return i=$(this).val(),null!=l.onKeyup&&l.onKeyup(l),""===i&&($(l.itemNode).removeClass(l.hiddenClass),t(),null!=l.onClear&&l.onClear(l)),t(),a()})},a=function(){return l.$query.each(function(){var e;return e=$(this),s(e)?e.closest(l.itemNode).addClass(l.hiddenClass):(e.closest(l.itemNode).removeClass(l.hiddenClass),null!=l.onFound?l.onFound(l):void 0)}),n()},t=function(){return l.emptyMessage&&$(l.emptyNode).length>0?$(l.emptyNode).remove():void 0},n=function(){var e;return r()&&(l.emptyMessage&&(e=l.emptyNode.replace(".","")),$("<p class='"+e+"'>\n  There are no results matching '"+i+"'.\n</p>").insertAfter($(l.itemNode).last()),null!=l.onEmpty)?l.onEmpty(l):void 0},s=function(e){return e.text().search(new RegExp(i,"i"))<0},r=function(){return $(""+l.itemNode+"."+l.hiddenClass).length===$(l.itemNode).length},{init:e}}(),this.Spellbook.loader=function(e){var t;return t=$.extend({$element:$(".js-loader-element"),$toggle:$(".js-loader-toggle"),$spinner:$("<span></span>"),$overlay:$("<div></div>"),spinnerClass:"loader",overlayClass:"loader-overlay",loadingClass:"is-loading"},e),t.$toggle.on("click",function(){return t.$element.toggleClass(t.loadingClass),t.$element.append(t.$spinner),t.$spinner.addClass(t.spinnerClass),t.$element.append(t.$overlay),t.$overlay.addClass(t.overlayClass)})},this.Spellbook.Modal=function(){var e,t,n,r,s,a,i,o,l;return t=null,e=null,o={},n=function(e){return o=$.extend({$trigger:$(".js-modal-trigger"),$close:$(".js-modal-close"),dataAttribute:"modal",backdropClass:"modal-backdrop",activeClass:"is-active",inactiveClass:"is-inactive",activeBodyClass:"is-modal-active"},e),i(),this},r=function(e,n,r,i){switch(null==r&&(r=!1),null==i&&(i=null),t=e,n){case"open":e.addClass(o.activeClass),$("body").addClass(o.activeBodyClass);break;case"close":e.removeClass(o.activeClass),$("body").removeClass(o.activeBodyClass),s()}return r||l(n),i&&i(),a()},l=function(t){switch(t){case"open":return $("<div class="+o.backdropClass+"></div>").appendTo($("body")),e=$("."+o.backdropClass),setTimeout(function(){return e.addClass(o.activeClass)},25);case"close":return e.removeClass(o.activeClass),setTimeout(function(){return e.remove()},500)}},i=function(){return o.$trigger.on("click",function(e){var n;return e.preventDefault(),n=$(this).data(o.dataAttribute),t=$(n),r(t,"open")})},a=function(){return o.$close.on("click",function(e){return e.preventDefault(),r(t,"close")}),e.on("click",function(){return r(t,"close")}),$(document).on("keydown",function(e){switch(e.which){case 27:return r(t,"close")}})},s=function(){return o.$close.off("click"),$(document).off("keydown")},{init:n,trigger:r}}(),this.Spellbook.QuantityInput=function(){var e,t,n,r,s,a,i;return r={},i=null,e=function(e){return r=$.extend({$element:$(".js-quantityInput"),$field:$(".js-quantityInput-field"),$increase:$(".js-quantityInput-increase"),$decrease:$(".js-quantityInput-decrease"),$target:$(".js-quantityInput-target"),targetBaseValue:29,targetValuePrefix:"$",minValue:1,maxValue:100,onIncrease:null,onDecrease:null,onTargetUpdate:null},e),n(),t()},n=function(){return i=parseInt(r.$element.val())},t=function(){return r.$element.on("keyup",function(){return n(),isNaN(i)||i<r.minValue||i>r.maxValue?void 0:a()}),r.$increase.on("click",function(e){return e.preventDefault(),i!==r.maxValue&&a("up"),null!=r.onIncrease?r.onIncrease(r):void 0}),r.$decrease.on("click",function(e){return e.preventDefault(),i!==r.minValue&&a("down"),null!=r.onDecrease?r.onDecrease(r):void 0})},a=function(e){switch(null==e&&(e=""),e){case"up":r.$element.val(++i);break;case"down":r.$element.val(--i);break;default:r.$element.val(i)}return s(),null!=r.onTargetUpdate?r.onTargetUpdate(r):void 0},s=function(){var e;return e=i*r.targetBaseValue,r.$target.text(""+r.targetValuePrefix+e)},{init:e}}(),this.Spellbook.QueryParams=function(){function e(e){this.options=e,this.init()}return e.prototype.params={},e.prototype.variables=[],e.prototype._settings={},e.prototype.init=function(){return this._settings=$.extend({url:null},this.options),this._parseQueryString(this._settings.url),this._sortParams()},e.prototype._parseQueryString=function(e){var t;return t=e?e.split("?")[1]:window.location.search.substring(1),this.variables=t.split("&")},e.prototype._sortParams=function(){var e,t,n,r,s,a;for(s=this.variables,a=[],n=0,r=s.length;r>n;n++)t=s[n],e=t.split("="),a.push(void 0!==e[1]?this.params[e[0]]=e[1]:void 0);return a},e.prototype.allParams=function(){return this.params},e.prototype.matchParamKey=function(e){var t,n,r;r=this.params;for(t in r)if(n=r[t],e===t)return!0;return!1},e.prototype.matchParamValue=function(e){var t,n,r;r=this.params;for(t in r)if(n=r[t],e===n)return!0;return!1},e}(),this.Spellbook.randomizer=function(e){var t;return t=Math.floor(Math.random()*e.length),e[t]},this.Spellbook.sanitize=function(e){return e.replace(/(<([^>]+)>)/gi,"")},this.Spellbook.SaveProgress=function(){var e,t,n,r,s,a;return s={},e=function(e){return s=$.extend({$element:$(".js-saveProgress"),$container:$(".js-saveProgress-container"),dataAttribute:"saveprogress"},e),n(),r()},t=function(e){return e.find(s.$element).each(function(){var e;return e=$(this).data(s.dataAttribute),localStorage.removeItem(e)})},n=function(){return s.$element.each(function(){var e,t,n;return e=$(this),t=e.data(s.dataAttribute),n=localStorage.getItem(t),e.val(n)})},r=function(){return s.$element.on("input",function(){var e,t,n;return e=$(this),t=e.data(s.dataAttribute),n=e.val(),a(t,n)}),s.$container.on("submit",function(){return t($(this))})},a=function(e,t){return localStorage.setItem(e,t)},{init:e}}(),this.Spellbook.scrollTo=function(e){var t;return t=$.extend({$element:$(".js-scrollTo"),speed:250},e),t.$element.on("click",function(e){var n;return e.preventDefault(),n=t.$element.attr("href"),$("body, html").animate({scrollTop:parseInt($(n).offset().top)},t.speed)})},this.Spellbook.scrollTrigger=function(e){var t,n,r;return r=$.extend({$element:$(".js-scrollTrigger"),scrollPadding:400,activeClass:"is-active"},e),n=$(window).scrollTop(),r.$element.offset().top>=0&&(t=n-r.$element.offset().top-r.scrollPadding),!r.$element.hasClass(r.activeClass)&&t?r.$element.addClass(r.activeClass):void 0},this.Spellbook.selectText=function(e){var t,n;return n=$.extend({$element:$(".js-selectText"),onClick:null},e),t=function(e){var t,n,r;return t=e[0],document.body.createTextRange?(n=document.body.createTextRange(),n.moveToElementText(t),n.select()):window.getSelection?(r=window.getSelection(),n=document.createRange(),n.selectNodeContents(t),r.removeAllRanges(),r.addRange(n)):void 0},n.$element.on("click",function(){return t($element),$(this).trigger("focus").trigger("select"),null!=n.onClick?n.onClick(n):void 0})},this.Spellbook.Share=function(){var e,t,n,r;return n={},e=function(e){return n=$.extend({$element:$(".js-share"),popup:{height:400,width:575,left:0,top:0}},e),t()},t=function(){return n.$element.on("click",function(e){var t,n,s,a;return e.preventDefault(),t=$(this),a=t.attr("href"),s=t.data("share-service"),n=t.data("share-text"),r(s,a,n)})},r=function(e,t,r){var s;switch(s="width="+n.popup.width+", height="+n.popup.height+", top="+n.popup.top+", left="+n.popup.left,e){case"twitter":t="https://twitter.com/share?text="+r+"&url="+t;break;case"facebook":t="https://www.facebook.com/sharer/sharer.php?u="+t,e="facebook-share-dialog";break;case"google":t="https://plus.google.com/share?url="+t}return window.open(t,e,s)},{init:e}}(),this.Spellbook.shortcut=function(e){var t;return t=$.extend({$element:$("[data-shortcut]"),dataAttribute:"shortcut",keyCodes:Spellbook.keyCodes},e),t.$element.each(function(){var e;return e=t.keyCodes[$(this).data(t.dataAttribute)],$(document).on("keyup",function(t){return function(n){var r,s;return r=$(t),s=n.target.tagName.toLowerCase(),"input"!==s&&"textarea"!==s&&n.which===e&&(r.trigger("focus").trigger("click"),"a"===r.prop("tagName").toLowerCase())?window.location=r.attr("href"):void 0}}(this))})},this.Spellbook.ShowPassword=function(){var e,t,n,r;return n={},e=function(e){return n=$.extend({$input:$(".js-showPassword-input"),$toggle:$(".js-showPassword-toggle"),showByDefault:!1},e),t(),n.showByDefault?r():void 0},t=function(){return n.$toggle.on("change",function(){var e;return e=$(this).prop("checked"),e?r():n.$input.attr("type","password")})},r=function(){return n.$input.attr("type","text"),n.$toggle.prop("checked",!0)},{init:e}}(),this.Spellbook.slugify=function(e){return e.toLowerCase().replace(/[^\w ]+/g,"").replace(/\s+/g,"-")},this.Spellbook.StateUrls=function(){var e,t,n,r,s,a,i;return a={},e=function(e){return a=$.extend({$element:$(".js-stateUrls"),$link:$(".js-stateUrls-link"),hiddenClass:"is-hidden",activeClass:"is-active",dataAttribute:"state"},e),s(t()),r()},n=function(e){return e.replace(/(<([^>]+)>)/gi,"")},t=function(){var e;return e=window.location.hash?n(window.location.hash):a.$link.first().attr("href")},s=function(e){return a.$element.not(e).addClass(a.hiddenClass),$("[data-"+a.dataAttribute+"="+e+"]").removeClass(a.hiddenClass).addClass(a.activeClass)},r=function(){return a.$link.on("click",function(e){var t,n;return e.preventDefault(),t=$(this),n=t.attr("href"),history.pushState?history.pushState(null,null,n):window.location.hash=n,$(n).length>0?i(t,n):void 0})},i=function(e,t){return a.$link.removeClass(a.activeClass),a.$element.addClass(a.hiddenClass),e.addClass(a.activeClass),$(t).removeClass(a.hiddenClass)},{init:e}}(),this.Spellbook.toggle=function(e){var t;switch(t=$.extend({$element:$(".js-toggle"),proximity:"next",event:"click",toggleClass:"is-hidden",activeClass:"is-active"},e),t.event){case"click":return t.$element.on("click",function(e){var n;switch(e.preventDefault(),n=$(this),t.$element.toggleClass(t.activeClass),t.proximity){case"next":return n.next().toggleClass(t.toggleClass);case"prev":return n.prev().toggleClass(t.toggleClass);case"nextParent":return n.parent().next().toggleClass(t.toggleClass);case"prevParent":return n.parent().prev().toggleClass(t.toggleClass);default:return t.proximity.toggleClass(t.toggleClass)}});case"hover":return t.initialState&&t.initialState(),t.$element.on({mouseenter:function(){var e;switch(e=$(this),e.addClass(t.activeClass),t.proximity){case"next":return e.next().addClass(t.toggleClass);case"prev":return e.prev().addClass(t.toggleClass);case"nextParent":return e.parent().next().addClass(t.toggleClass);case"prevParent":return e.parent().prev().addClass(t.toggleClass);default:return t.proximity.addClass(t.toggleClass)}},mouseleave:function(){var e;switch(e=$(this),e.removeClass(t.activeClass),t.proximity){case"next":return e.next().removeClass(t.toggleClass);case"prev":return e.prev().removeClass(t.toggleClass);case"nextParent":return e.parent().next().removeClass(t.toggleClass);case"prevParent":return e.parent().prev().removeClass(t.toggleClass);default:return t.proximity.removeClass(t.toggleClass)}}})}},this.Spellbook.uid=function(e){var t;for(null==e&&(e=10),t="";t.length<e;)t+=Math.random().toString(36).substr(2);return t.substr(0,e)};